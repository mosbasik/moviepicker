{% extends  'base.html' %}

{% block content %}

<div class="container">
    <div class="row vertical-divide">
        <div class="col-sm-12">
            <h1>
                <span>{{ group.name }}</span>

                {% if user.is_authenticated %}
                    {% if group in user.movie_groups.all %}
                        <button class="btn btn-danger pull-right leave-group-button" data-group-slug="{{ group.slug }}" data-group-action="leave">Leave Group</button>
                    {% else %}
                        <button class="btn btn-success pull-right join-group-button" data-group-slug="{{ group.slug }}" data-group-action="join">Join Group</button>
                    {% endif %}
                {% else %}
                    <button class="btn btn-success pull-right join-group-button" data-group-slug="{{ group.slug }}" data-group-action="join">Join Group</button>
                {% endif %}
            </h1>
        </div>

    </div>
    <div class="row">
        <div class="col-sm-2">
            <h2>Users:</h2>
            <ul>
                {% for user in users %}
                    <li>{{ user.username }}</li>
                {% endfor %}
            </ul>
        </div>

        <div class="col-sm-5">
            <h2>Upcoming Events:</h2>
            {% for event in group.events.all %}
                <div class="event-summary-wrapper">
                    <p class="event-summary"><a href="{% url 'event_details' event.group.slug event.pk %}">{{ event.name }}</a><span class="pull-right">{% if event.is_showing %}Now active!{% else %}{{ event.date_and_time|timeuntil }}{% endif %}</span></p>
                    <p class="event-summary body">{% if event.is_locked %}<span class="glyphicon glyphicon-lock pull-left"></span>{% else %}<span class="glyphicon glyphicon-arrow-up pull-left"></span>{% endif %} <a href="{% url 'movie_details' event.leader.imdb_id %}">{{ event.leader.title }} [{{ event.leader.year }}]</a></p>
                </div>
            {% endfor %}
        </div>

        <div class="col-sm-5">
            <h2><a href="{% url 'create_event' %}">Register New Event</a></h2>
            <p>(The form is going to occupy this space soon.)</p>
        </div>
    </div>

    <div class="row">
        {% include "movie_list.html" %}
    </div>
</div>

{% endblock content %}
